<!DOCTYPE html>
<html>
<head>
    <title>EC2 Instance Manager</title>
    <!-- Add Bootstrap CSS for styling -->
    <link
        rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    >
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">EC2 Instance Manager</h1>
        <!-- Form Fields -->
        <form method="POST" action="/" id="filterForm">
            <div class="form-row">
                <div class="form-group col-md-3">
                    <label for="awsAccountName">AWS Account Name</label>
                    <select name="awsAccountName" class="form-control" onchange="submitForm()">
                        <option value="">All Accounts</option>
                        {{range .UniqueAWSAccountNames}}
                        <option value="{{.}}" {{if eq . $.SelectedAWSAccountName}}selected{{end}}>{{.}}</option>
                        {{end}}
                    </select>
                </div>
                <div class="form-group col-md-3">
                    <label for="service">Service</label>
                    <select name="service" class="form-control" onchange="submitForm()">
                        <option value="">All Services</option>
                        {{range .UniqueServices}}
                        <option value="{{.}}" {{if eq . $.SelectedService}}selected{{end}}>{{.}}</option>
                        {{end}}
                    </select>
                </div>
                <div class="form-group col-md-3">
                    <label for="owner">Owner</label>
                    <select name="owner" class="form-control" onchange="submitForm()">
                        <option value="">All Owners</option>
                        {{range .UniqueOwners}}
                        <option value="{{.}}" {{if eq . $.SelectedOwner}}selected{{end}}>{{.}}</option>
                        {{end}}
                    </select>
                </div>
                <div class="form-group col-md-3">
                    <label for="region">Region</label>
                    <select name="region" class="form-control" onchange="submitForm()">
                        <option value="">All Regions</option>
                        {{range .UniqueRegions}}
                        <option value="{{.}}" {{if eq . $.SelectedRegion}}selected{{end}}>{{.}}</option>
                        {{end}}
                    </select>
                </div>
            </div>
        </form>
        <!-- Table to display EC2 Instances -->
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Select</th>
                    <th>AWS Account Name</th>
                    <th>State</th>
                    <th>Name</th>
                    <th>Instance ID</th>
                    <th>Service</th>
                    <th>Owner</th>
                    <th>Region</th>
                </tr>
            </thead>
            <tbody>
                {{if .Instances}}
                {{range .Instances}}
                <tr>
                    <td><input type="checkbox" name="instanceIDs" value="{{.ID}}"></td>
                    <td>{{.AWSAccountName}}</td>
                    <td>{{.State}}</td>
                    <td>{{.EC2Name}}</td>
                    <td>{{.ID}}</td>
                    <td>{{.Service}}</td>
                    <td>{{.Owner}}</td>
                    <td>{{.Region}}</td>
                </tr>
                {{end}}
                {{else}}
                <tr>
                    <td colspan="8" class="text-center">No instances found for the selected criteria.</td>
                </tr>
                {{end}}
            </tbody>
        </table>
        <button type="submit" formaction="/restart" formmethod="post" class="btn btn-danger">Restart Selected Instances</button>
    </div>
    <!-- Optional JavaScript -->
    <script>
        function submitForm() {
            document.getElementById('filterForm').submit();
        }
    </script>
</body>
</html>
  